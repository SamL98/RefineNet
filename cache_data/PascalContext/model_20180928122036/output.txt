


=====================================================================
gen ds_info
ds_config:
         use_dummy_gt: 0
      use_custom_data: 0
              ds_name: 'PascalContext'
       gen_ds_info_fn: @my_gen_ds_info_pascalcontext
    ds_info_cache_dir: '../datasets/PascalContext'

file exist:../datasets/PascalContext/my_dataset_info.mat
load_file:../datasets/PascalContext/my_dataset_info.mat



=====================================================================
run network
train_opts:
                             use_gpu: 0
                             gpu_idx: 1
            input_img_short_edge_min: 450
            input_img_short_edge_max: 1100
                     input_img_scale: 1
                        use_dummy_gt: 0
                      root_cache_dir: '../cache_data/PascalContext/model_20180928122036'
                          model_name: 'model_20180928122036'
                        run_dir_name: 'main'
                       run_file_name: 'demo_refinenet_train'
                         run_evaonly: 0
                  trained_model_path: []
                       learning_rate: 5.0000e-04
                           epoch_num: 600
                      cache_data_mem: 0
                       crop_box_size: 400
                        eva_run_step: 5
                       snapshot_step: 1
               init_resnet_layer_num: 50
                      gen_network_fn: @gen_network_main
                     gen_net_opts_fn: @gen_net_opts_model_type1
                           eva_param: [1×1 struct]
                get_batch_ds_info_fn: @my_get_batch_ds_info
                epoch_model_cache_fn: @my_epoch_model_cache
                     batch_disp_step: 0.2000
                     net_run_verbose: 0
                          batch_size: 1
               bnorm_moment_type_trn: 'global'
               bnorm_moment_type_tst: 'global'
                     optimizer_param: [1×1 struct]
                    model_cache_step: 5
                            do_train: 1
                          do_eva_val: 1
                      do_cache_model: 1
                       fig_plot_step: 1
                     input_net_do_bp: 1
                epoch_task_subsample: 1
                  epoch_task_num_min: 1000
                  epoch_task_num_max: 2000
        epoch_run_max_task_one_class: 100
           epoch_task_gen_type_train: 'class_sample'
                     data_aug_config: [1×1 struct]
                    data_crop_config: [1×1 struct]
         input_featnet_lr_multiplier: 0.1000
                net_input_img_scales: 1.2000
                       refine_config: [1×1 struct]
               input_featnet_configs: {[1×1 struct]}
                         loss_config: [1×1 struct]
                     model_cache_dir: '../cache_data/PascalContext/model_20180928122036/model_cache'
                  model_snapshot_dir: '../cache_data/PascalContext/model_20180928122036/model_cache/snapshot'
                       eva_run_start: 5
                     eva_epoch_idxes: [1×120 double]
    model_cache_epoch_idxes_snapshot: [1×600 double]
             model_cache_epoch_idxes: [1×120 double]
                        net_run_opts: [1×1 struct]

train_opts.eva_param:
                      class_info: [1×1 struct]
         predict_result_dir_mask: '../cache_data/PascalContext/model_20180928122036/predict_result_mask'
         predict_result_dir_full: '../cache_data/PascalContext/model_20180928122036/predict_result_full'
    skip_existing_prediction_eva: 0
               save_predict_mask: 0
        save_predict_result_full: 0
        eva_densecrf_postprocess: 0



-------------------------------------------------------------

prepare_running_model...
check model: ../cache_data/PascalContext/model_20180928122036/model_cache/snapshot 
file not exist:../cache_data/PascalContext/model_20180928122036/model_cache/snapshot
model snapshot not existed

 generate network...

load init model:../model_trained/imagenet-resnet-50-dag.mat


-------------------------------------------------------------

gen_crop_cache_info...
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',108,1)">108 </a>    my_check_valid_numeric(predict_scores);
size(predict_scores)

ans =

   120   120    60

mc_info

mc_info = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                  class_num: 60
              node_map_size: [120 120]
                   node_num: 14400
                      e_num: 14400
              gt_label_data: [120×120 double]
    example_non_valid_flags: []
                valid_e_num: 14400

dbstep
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',109,1)">109 </a>    map_size=size(predict_scores);
dbstep
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',111,1)">111 </a>    assert(map_size(3)==mc_info.class_num);
map_size

map_size =

   120   120    60

dbstep
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',112,1)">112 </a>    assert(all(map_size(1:2)==mc_info.node_map_size));
dbstep
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',114,1)">114 </a>    predict_scores=single(predict_scores);
dbstep
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',115,1)">115 </a>    predict_scores=reshape(predict_scores, [mc_info.node_num, mc_info.class_num]);
size(predict_scores)

ans =

   120   120    60

dbstep
<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/cnn_layer_dense_softmaxloss_forward.m',116,1)">116 </a>    predict_scores=my_softmax(predict_scores);
dbquit
run demo_refinenet_train.m
