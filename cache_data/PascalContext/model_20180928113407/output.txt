


=====================================================================
gen ds_info
ds_config:
         use_dummy_gt: 0
      use_custom_data: 0
              ds_name: 'PascalContext'
       gen_ds_info_fn: @my_gen_ds_info_pascalcontext
    ds_info_cache_dir: '../datasets/PascalContext'

file exist:../datasets/PascalContext/my_dataset_info.mat
load_file:../datasets/PascalContext/my_dataset_info.mat



=====================================================================
run network
train_opts:
                             use_gpu: 0
                             gpu_idx: 1
            input_img_short_edge_min: 450
            input_img_short_edge_max: 1100
                     input_img_scale: 1
                        use_dummy_gt: 0
                      root_cache_dir: '../cache_data/PascalContext/model_20180928113407'
                          model_name: 'model_20180928113407'
                        run_dir_name: 'main'
                       run_file_name: 'demo_refinenet_train'
                         run_evaonly: 0
                  trained_model_path: []
                       learning_rate: 5.0000e-04
                           epoch_num: 600
                      cache_data_mem: 0
                       crop_box_size: 400
                        eva_run_step: 5
                       snapshot_step: 1
               init_resnet_layer_num: 50
                      gen_network_fn: @gen_network_main
                     gen_net_opts_fn: @gen_net_opts_model_type1
                           eva_param: [1×1 struct]
                get_batch_ds_info_fn: @my_get_batch_ds_info
                epoch_model_cache_fn: @my_epoch_model_cache
                     batch_disp_step: 0.2000
                     net_run_verbose: 0
                          batch_size: 1
               bnorm_moment_type_trn: 'global'
               bnorm_moment_type_tst: 'global'
                     optimizer_param: [1×1 struct]
                    model_cache_step: 5
                            do_train: 1
                          do_eva_val: 1
                      do_cache_model: 1
                       fig_plot_step: 1
                     input_net_do_bp: 1
                epoch_task_subsample: 1
                  epoch_task_num_min: 1000
                  epoch_task_num_max: 2000
        epoch_run_max_task_one_class: 100
           epoch_task_gen_type_train: 'class_sample'
                     data_aug_config: [1×1 struct]
                    data_crop_config: [1×1 struct]
         input_featnet_lr_multiplier: 0.1000
                net_input_img_scales: 1.2000
                       refine_config: [1×1 struct]
               input_featnet_configs: {[1×1 struct]}
                         loss_config: [1×1 struct]
                     model_cache_dir: '../cache_data/PascalContext/model_20180928113407/model_cache'
                  model_snapshot_dir: '../cache_data/PascalContext/model_20180928113407/model_cache/snapshot'
                       eva_run_start: 5
                     eva_epoch_idxes: [1×120 double]
    model_cache_epoch_idxes_snapshot: [1×600 double]
             model_cache_epoch_idxes: [1×120 double]
                        net_run_opts: [1×1 struct]

train_opts.eva_param:
                      class_info: [1×1 struct]
         predict_result_dir_mask: '../cache_data/PascalContext/model_20180928113407/predict_result_mask'
         predict_result_dir_full: '../cache_data/PascalContext/model_20180928113407/predict_result_full'
    skip_existing_prediction_eva: 0
               save_predict_mask: 0
        save_predict_result_full: 0
        eva_densecrf_postprocess: 0



-------------------------------------------------------------

prepare_running_model...
check model: ../cache_data/PascalContext/model_20180928113407/model_cache/snapshot 
file not exist:../cache_data/PascalContext/model_20180928113407/model_cache/snapshot
model snapshot not existed

 generate network...

load init model:../model_trained/imagenet-resnet-50-dag.mat
{Operation terminated by user during
<a href="matlab:matlab.internal.language.introspective.errorDocCallback('My_net_util.add_conv_layer_dagnn', '/Users/samlerner/Projects/refinenet/main/My_net_util.m', 215)" style="font-weight:bold">My_net_util.add_conv_layer_dagnn</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/My_net_util.m',215,0)">line 215</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('My_net_util.add_dim_reduce_layer_named', '/Users/samlerner/Projects/refinenet/main/My_net_util.m', 195)" style="font-weight:bold">My_net_util.add_dim_reduce_layer_named</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/My_net_util.m',195,0)">line 195</a>)
My_net_util.add_conv_layer_dagnn(dag_net, inputs, outputs, false,
filter_size, layer_name, false)

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('My_net_util.add_dim_reduce_layer', '/Users/samlerner/Projects/refinenet/main/My_net_util.m', 184)" style="font-weight:bold">My_net_util.add_dim_reduce_layer</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/My_net_util.m',184,0)">line 184</a>)
[outputs,
layer_name]=My_net_util.add_dim_reduce_layer_named(dag_net,
input_var_name, input_dim, target_dim, layer_name);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('My_net_util.add_res_conv_block', '/Users/samlerner/Projects/refinenet/main/My_net_util.m', 353)" style="font-weight:bold">My_net_util.add_res_conv_block</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/My_net_util.m',353,0)">line 353</a>)
        one_outputs=My_net_util.add_dim_reduce_layer(dag_net,
        one_outputs{1}, feat_dim_before, feat_dim_after);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_network_refine_group>do_gen_one_refinenet', '/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m', 326)" style="font-weight:bold">gen_network_refine_group>do_gen_one_refinenet</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m',326,0)">line 326</a>)
        mainflow_layer_gen_info=My_net_util.add_res_conv_block(dag_net,
        mainflow_layer_gen_info, one_output_dim, conv_num,
        layer_name_prefix);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_network_refine_group>do_gen_multi_refinenets', '/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m', 371)" style="font-weight:bold">gen_network_refine_group>do_gen_multi_refinenets</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m',371,0)">line 371</a>)
        prev_output_info=do_gen_one_refinenet(dag_net,
        one_refine_config, one_net_input_info, ['_g'
        num2str(g_idx)]);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_network_refine_group>gen_multi_refinenets', '/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m', 101)" style="font-weight:bold">gen_network_refine_group>gen_multi_refinenets</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m',101,0)">line 101</a>)
net_output_info=do_gen_multi_refinenets(dag_net, refine_config,
net_input_info);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_network_refine_group', '/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m', 20)" style="font-weight:bold">gen_network_refine_group</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/gen_network_refine_group.m',20,0)">line 20</a>)
[one_layers, net_output_info]=gen_multi_refinenets(dag_net,
train_opts.refine_config, net_input_info);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_network_main', '/Users/samlerner/Projects/refinenet/main/gen_network_main.m', 16)" style="font-weight:bold">gen_network_main</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/gen_network_main.m',16,0)">line 16</a>)
group_output_info=gen_network_refine_group(train_opts, net_config,
group_output_info);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('prepare_running_model>do_prepare_train', '/Users/samlerner/Projects/refinenet/main/prepare_running_model.m', 79)" style="font-weight:bold">prepare_running_model>do_prepare_train</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/prepare_running_model.m',79,0)">line 79</a>)
net_config=train_opts.gen_network_fn(train_opts);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('prepare_running_model', '/Users/samlerner/Projects/refinenet/main/prepare_running_model.m', 11)" style="font-weight:bold">prepare_running_model</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/prepare_running_model.m',11,0)">line 11</a>)
    [net_config, net_exp_info]=do_prepare_train(train_opts);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('demo_refinenet_train', '/Users/samlerner/Projects/refinenet/main/demo_refinenet_train.m', 223)" style="font-weight:bold">demo_refinenet_train</a> (<a href="matlab: opentoline('/Users/samlerner/Projects/refinenet/main/demo_refinenet_train.m',223,0)">line 223</a>)
[net_config, net_exp_info]=prepare_running_model(train_opts);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('run', '/Applications/MATLAB_R2018a.app/toolbox/matlab/lang/run.m', 91)" style="font-weight:bold">run</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2018a.app/toolbox/matlab/lang/run.m',91,0)">line 91</a>)
evalin('caller', strcat(script, ';'));
} 
run demo_refinenet_train.m
